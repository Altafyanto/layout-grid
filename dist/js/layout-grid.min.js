"use strict";function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),Grid=function(){function a(){var b=arguments.length<=0||void 0===arguments[0]?[]:arguments[0];_classCallCheck(this,a),this.rects=b}return _createClass(a,[{key:"getIntersectingRects",value:function(a){return this.rects.filter(function(b){return a!==b&&a.intersect(b)})}},{key:"compact",value:function(){var a=this,b=[].concat(_toConsumableArray(this.rects));return b.sort(function(a,b){return a.y-b.y}).forEach(function(b){do b.y-=1;while(b.y>=0&&0===a.getIntersectingRects(b).length);b.y+=1}),this}},{key:"height",value:function(){var a=this.rects.map(function(a){return a.bottom()});return a.length?Math.max.apply(Math,_toConsumableArray(a)):0}},{key:"updateNoOverlap",value:function(a,b){this.update(a,b);var c=!0,d=!1,e=void 0;try{for(var f,g=this.getIntersectingRects(a)[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value;this.updateNoOverlap(h,{x:h.x,y:a.bottom()})}}catch(i){d=!0,e=i}finally{try{!c&&g["return"]&&g["return"]()}finally{if(d)throw e}}return this}},{key:"update",value:function(a,b){return a.x="x"in b?b.x:a.x,a.y="y"in b?b.y:a.y,a.w="w"in b?b.w:a.w,a.h="h"in b?b.h:a.h,this}}]),a}();!function(a){function b(){return Math.round((new Date).getTime()+100*Math.random())}a.fn.lt_ensure_id=function(){return this.filter(function(){return!this.id}).each(function(){this.id="rect-"+b()}),this}}(jQuery);var LTGrid=function(a){var b="lt_grid",c="lt.grid",d="."+c,e={START:"dragstart."+d+" touchstart."+d,OVER:"dragover."+d+" touchmove."+d,END:"dragend."+d+" touchcancel."+d,DROP:"drop."+d+" touchend."+d,LEAVE:"dropleave."+d},f={GRID:'[data-arrange="layout-grid"]',WIDGET:'[data-arrange="layout-grid"] .lt'},g={resize:!0,overlap:!1,compact:!0,params:{lg:{gap:1,maxWidth:Number.MAX_VALUE,cols:4,aspect:2/3},md:{gap:2,maxWidth:1200,cols:3,aspect:2/3},sm:{gap:3,maxWidth:992,cols:2,aspect:2/3},xs:{gap:4,maxWidth:768,cols:1,aspect:2/3}}},h=function(){function b(c){var d=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,b),this._element=a(c),this._options=this._getOptions(d),this._mask=null,this._ghost=null}return _createClass(b,[{key:"option",value:function(a,b){this._options[a]=b}},{key:"windowWidth",value:function(){return a(window).width()}},{key:"size",value:function d(){var a=void 0,b=this.windowWidth();for(var d in this._options.params)b<this._options.params[d].maxWidth&&(a=d);return a}},{key:"ghost",value:function(b){return null===this._ghost&&(this._ghost=a('<div class="'+b.attr("class")+' lt-ghost"></div>'),this._element.append(this._ghost)),this._ghost}},{key:"removeGhost",value:function(){this._ghost&&(this._ghost.remove(),this._ghost=null)}},{key:"compact",value:function(){var a=this.size(),b=this.grid(a);this.grid(a,b.compact())}},{key:"resize",value:function(){var a=this.size(),b=new Rect(0,0,0,this.grid(a).height()),c=b.setCss(this._element.attr("class"),a);this._element.attr("class",c)}},{key:"moveGhost",value:function(a,b,c){var d=this.size(),e=this.ghost(a),f=e.lt_rect(d),g=this.options.params[d].gap,h=this.options.params[d].cols;f.x=Math.floor(b/(this._itemWidth(d)+g)),f.y=Math.floor(c/(this._itemHeight(d)+g)),f.x=Math.min(Math.max(0,f.x),h-f.w),e.lt_rect(d,f)}},{key:"end",value:function(){this.removeMask(),this.removeGhost(),this.update()}},{key:"update",value:function(){this._options.compact&&this.compact(),this._options.resize&&this.resize()}},{key:"mask",value:function(){return null===this._mask&&(this._mask=a('<div class="lt-mask" data-lt-grid="mask"></div>'),this._element.append(this._mask)),this._mask}},{key:"removeMask",value:function(){null!==this._mask&&(this._mask.remove(),this._mask=null)}},{key:"grid",value:function(b,c){var d=this._element.children("[draggable]");if(void 0===c)return new Grid(a.map(d.toArray(),function(c){return a(c).lt_rect(b)}));for(var e in c.rects)d.eq(e).lt_rect(b,c.rects[e])}},{key:"reposition",value:function(a,b){var c=this.size(),d=a.lt_rect(c),e=this.grid(c);this.options.overlap?e.update(d,b):e.updateNoOverlap(d,b),this.grid(c,e),this.update()}},{key:"moveToGhost",value:function(a){var b=this.size(),c=a.parent(),d=this.ghost(a),e=d.lt_rect(b);this._element.append(a),this.reposition(a,{x:e.x,y:e.y}),c.add(this._element).lt_grid("update")}},{key:"_itemWidth",value:function(a){var b=this._options.params[a].cols,c=this._options.params[a].gap;return(this._element.width()-(b-1)*c)/b}},{key:"_itemHeight",value:function(a){var b=this._options.params[a].aspect;return this._itemWidth(a)*b}},{key:"_getOptions",value:function(b){return a.extend({},g,b)}},{key:"options",get:function(){return this._options}}],[{key:"_jQueryInterface",value:function(d,e,f,h){return this.each(function(){var i=a(this),j=i.data(c),k=a.extend(!0,{},g,i.data(),"object"==typeof d&&d);j||(j=new b(this,k),i.data(c,j)),"string"==typeof d&&j[d](e,f,h)})}},{key:"Default",get:function(){return g}},{key:"DATA_KEY",get:function(){return c}}]),b}();return a(document).on(e.START,f.WIDGET,function(b){Store.set(b,a(this))}).on(e.OVER,f.GRID,function(b){var c=Store.get(b),d=a(this);if(c){var e=b.originalEvent.touches?b.originalEvent.touches[0]:b.originalEvent,f=e.pageX-d.offset().left,g=e.pageY-d.offset().top;b.preventDefault(),d.lt_grid("mask").lt_grid("moveGhost",c,f,g)}}).on(e.END,f.GRID,function(){a(this).lt_grid("end")}).on(e.LEAVE,f.GRID,function(b){b.preventDefault(),"mask"===a(b.target).data("lt-grid")&&a(this).lt_grid("end")}).on(e.DROP,f.GRID,function(b){var c=Store.get(b);c&&(b.preventDefault(),a(this).lt_grid("moveToGhost",c).lt_grid("end"))}),a.fn[b]=h._jQueryInterface,a.fn[b].LTGrid=h,h}(jQuery)(function(a){a.fn.lt_rect=function(a,b){return void 0===b?(void 0===this.data("lt-item-"+a)&&this.data("lt-item-"+a,(new Rect).loadCss(this.attr("class"),a)),this.data("lt-item-"+a)):(this.data("lt-item-"+a,b),this.attr("class",b.setCss(this.attr("class"),a)),this)}})(jQuery)(function(a){a.fn.lt_size=function(){return this.lt_grid().data(LTGrid.DATA_KEY).size()}})(jQuery),Rect=function(){function a(){var b=arguments.length<=0||void 0===arguments[0]?0:arguments[0],c=arguments.length<=1||void 0===arguments[1]?0:arguments[1],d=arguments.length<=2||void 0===arguments[2]?1:arguments[2],e=arguments.length<=3||void 0===arguments[3]?1:arguments[3];_classCallCheck(this,a),this.x=b,this.y=c,this.w=d,this.h=e}return _createClass(a,[{key:"bottom",value:function(){return this.y+this.h}},{key:"right",value:function(){return this.x+this.w}},{key:"intersect",value:function(a){return this.x<a.right()&&this.right()>a.x&&this.y<a.bottom()&&this.bottom()>a.y}},{key:"setCss",value:function(a,b){for(var c=["x","y","w","h"],d=0;d<c.length;d++){var e=c[d];a=a.replace(new RegExp("lt-"+b+"-"+e+"-(\\d+)"),"lt-"+b+"-"+e+"-"+this[e])}return a}},{key:"loadCss",value:function(a,b){for(var c=["x","y","w","h"],d=0;d<c.length;d++){var e=c[d],f=a.match(new RegExp("lt-"+b+"-"+e+"-(\\d+)"));f&&(this[e]=parseInt(f[1]))}return this}}]),a}(),Store=function(a){var b=function(){function b(){_classCallCheck(this,b)}return _createClass(b,null,[{key:"clear",value:function(){this.item=null}},{key:"set",value:function(a,b){this.item=JSON.stringify({LTWidget:"#"+b.lt_ensure_id().attr("id")}),a.originalEvent.dataTransfer&&a.originalEvent.dataTransfer.setData("text",this.item)}},{key:"get",value:function(b){var c=b.originalEvent.dataTransfer&&b.originalEvent.dataTransfer.getData("text")||this.item;if(c){var d=JSON.parse(c);return a(d.LTWidget)}}}]),b}();return b}(jQuery);