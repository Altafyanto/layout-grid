+function(a,b){"use strict";function c(b,c,d,e){return this.each(function(){var g=a(this),h=g.data("cl.lt_grid"),i=a.extend(!0,{},f.DEFAULTS,g.data(),"object"==typeof b&&b);h||g.data("cl.lt_grid",h=new f(this,i)),"string"==typeof b&&h[b](c,d,e)})}var d=function(a,b,c,d){this.x=a||0,this.y=b||0,this.w=c||1,this.h=d||1};d.prototype.bottom=function(){return this.y+this.h},d.prototype.right=function(){return this.x+this.w},d.prototype.intersect=function(a){return this.x<a.right()&&this.right()>a.x&&this.y<a.bottom()&&this.bottom()>a.y},d.prototype.setCss=function(a,b){var c=this;return["x","y","w","h"].forEach(function(d){a=a.replace(new RegExp("lt-"+b+"-"+d+"-(\\d+)"),"lt-"+b+"-"+d+"-"+c[d])}),a},d.prototype.loadCss=function(a,b){var c=this;return["x","y","w","h"].forEach(function(d){var e=a.match(new RegExp("lt-"+b+"-"+d+"-(\\d+)"));e&&(c[d]=parseInt(e[1]))}),this};var e=function(a){this.rects=a||[]};e.prototype.getIntersectingRects=function(b){return a.grep(this.rects,function(a){return b!==a&&b.intersect(a)})},e.prototype.compact=function(){var b=this,c=this.rects.slice(0).sort(function(a,b){return a.y-b.y});return a.each(c,function(){do this.y-=1;while(this.y>=0&&0===b.getIntersectingRects(this).length);this.y+=1}),this},e.prototype.height=function(){var b=a.map(this.rects,function(a){return a.bottom()});return b?Math.max.apply(null,b):0},e.prototype.moveNoOverlap=function(b,c,d){var e=this;return this.move(b,c,d),a.each(this.getIntersectingRects(b),function(){e.moveNoOverlap(this,this.x,b.bottom())}),this},e.prototype.move=function(a,b,c){return a.x=b,a.y=c,this},a.fn.lt_rect=function(a,c){return b===c?(b===this.data("lt-item-"+a)&&this.data("lt-item-"+a,(new d).loadCss(this.attr("class"),a)),this.data("lt-item-"+a)):(this.data("lt-item-"+a,c),this.attr("class",c.setCss(this.attr("class"),a)),this)},a.fn.lt_ensure_id=function(){return this.filter(function(){return!this.id}).each(function(){this.id="rect-"+Math.round((new Date).getTime()+100*Math.random())}),this};var f=function(b,c){this.$element=a(b),this.$ghost=null,this.$mask=null,this.options=c};f.DEFAULTS={resize:!0,overlap:!1,compact:!0,params:{lg:{gap:1,maxWidth:Number.MAX_VALUE,cols:4,aspect:2/3},md:{gap:2,maxWidth:1200,cols:3,aspect:2/3},sm:{gap:3,maxWidth:992,cols:2,aspect:2/3},xs:{gap:4,maxWidth:768,cols:1,aspect:2/3}}},f.prototype.option=function(a,b){this.options[a]=b},f.prototype.size=function(){var b,c=a(window).width();return a.each(this.options.params,function(a,d){c<d.maxWidth&&(b=a)}),b},f.prototype.ghost=function(b){return null===this.$ghost&&(this.$ghost=a('<div class="'+b.attr("class")+' lt-ghost"></div>'),this.$element.append(this.$ghost)),this.$ghost},f.prototype.removeGhost=function(){this.$ghost&&(this.$ghost.remove(),this.$ghost=null)},f.prototype.compact=function(){var a=this.size();this.grid(a,this.grid(a).compact())},f.prototype.resize=function(){var a=this.size(),b=new d(0,0,0,this.grid(a).height());this.$element.attr("class",b.setCss(this.$element.attr("class"),a))},f.prototype.itemWidth=function(a){return(this.$element.width()-(this.options.params[a].cols-1)*this.options.params[a].gap)/this.options.params[a].cols},f.prototype.itemHeight=function(a){return this.itemWidth(a)*this.options.params[a].aspect},f.prototype.moveGhost=function(a,b,c){var d=this.size(),e=this.ghost(a),f=e.lt_rect(d);f.x=Math.floor(b/(this.itemWidth(d)+this.options.params[d].gap)),f.y=Math.floor(c/(this.itemHeight(d)+this.options.params[d].gap)),f.x=Math.min(Math.max(0,f.x),this.options.params[d].cols-f.w),e.lt_rect(d,f)},f.prototype.end=function(){this.removeMask(),this.removeGhost(),this.options.compact&&this.compact(),this.options.resize&&this.resize()},f.prototype.mask=function(){return null===this.$mask&&(this.$mask=a('<div class="lt-mask" data-lt-grid="mask"></div>'),this.$element.append(this.$mask)),this.$mask},f.prototype.removeMask=function(){null!==this.$mask&&(this.$mask.remove(),this.$mask=null)},f.prototype.grid=function(c,d){var f=this.$element.children("[draggable]");return b===d?new e(a.map(f.toArray(),function(b){return a(b).lt_rect(c)})):void a.each(d.rects,function(a,b){f.eq(a).lt_rect(c,b)})},f.prototype.reposition=function(a,b,c){var d=this.size(),e=a.lt_rect(d),f=this.grid(d);this.options.overlap?f.move(e,b,c):f.moveNoOverlap(e,b,c),this.grid(d,f)},f.prototype.moveToGhost=function(a){var b=this.size(),c=a.parent(),d=this.ghost(a),e=d.lt_rect(b);this.$element.append(a),this.reposition(a,e.x,e.y),c.add(this.$element).lt_grid("end")},a.fn.lt_grid=c,a.fn.lt_grid.Constructor=f,a.lt={Grid:e,Rect:d},a(document).on("dragstart.layout-grid.data-api",'[data-arrange="layout-grid"] .lt',function(b){var c=JSON.stringify({LTWidget:"#"+a(this).lt_ensure_id().attr("id")});a.lt.currentEventData=c,b.originalEvent.dataTransfer.setData("text/plain",c)}).on("dragover.layout-grid.data-api",'[data-arrange="layout-grid"]',function(b){var c=a(this),d=b.originalEvent.dataTransfer.getData("text/plain")||a.lt.currentEventData;if(d){var e=JSON.parse(d),f=b.originalEvent.clientX+a(window).scrollLeft()-c.offset().left,g=b.originalEvent.clientY+a(window).scrollTop()-c.offset().top;e&&e.LTWidget&&(b.preventDefault(),c.lt_grid("mask").lt_grid("moveGhost",a(e.LTWidget),f,g))}}).on("dragend.layout-grid.data-api",'[data-arrange="layout-grid"]',function(b){a(this).lt_grid("end")}).on("dragleave.layout-grid.data-api",'[data-arrange="layout-grid"]',function(a){a.preventDefault()}).on("dragleave.layout-grid.data-api",'[data-arrange="layout-grid"]',function(b){b.preventDefault(),"mask"==a(b.target).data("lt-grid")&&a(this).lt_grid("end")}).on("drop.layout-grid.data-api",'[data-arrange="layout-grid"]',function(b){var c=JSON.parse(b.originalEvent.dataTransfer.getData("text/plain"));c&&c.LTWidget&&(b.preventDefault(),a(this).lt_grid("moveToGhost",a(c.LTWidget)).lt_grid("end"))})}(jQuery);